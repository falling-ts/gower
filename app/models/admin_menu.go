package models

func init() {
	migrate(new(AdminMenu))

	var count int64
	db.Model(&AdminMenu{}).Count(&count)
	if count == 0 {
		menus := []*AdminMenu{
			{
				Icon:     util.Ptr("M15.98 2.442H8.02L0 10.46h2.275l6.882-6.88 6.881 6.881H24l-8.02-8.018m-.492 9.348L9.157 5.459 4.01 10.605v4.987a1.33 1.33 0 0 0 1.329 1.329h6.077l4.637 4.637v-4.637h2.598a1.33 1.33 0 0 0 1.33-1.33V11.79h-4.494Z").(*string),
				Name:     "主页",
				Path:     util.Ptr("/admin").(*string),
				Order:    1,
				ParentID: util.Ptr(uint(0)).(*uint),
			},
			{
				Icon:     util.Ptr("M21.3 13.72a3.158 3.158 0 0 0-3.462.124.632.632 0 0 1-.682.035l-3.137-1.81a.08.08 0 0 1 0-.137l3.12-1.8a.632.632 0 0 1 .685.036 3.158 3.158 0 0 0 3.47.139A3.194 3.194 0 0 0 22.442 6.1a3.158 3.158 0 0 0-5.924 1.773.633.633 0 0 1-.311.606l-3.136 1.811a.08.08 0 0 1-.118-.068V6.6a.632.632 0 0 1 .372-.573 3.158 3.158 0 1 0-2.64 0 .632.632 0 0 1 .373.573v3.622a.08.08 0 0 1-.119.068L7.804 8.48a.632.632 0 0 1-.311-.605 3.157 3.157 0 1 0-1.307 2.294.633.633 0 0 1 .687-.038l3.12 1.8a.08.08 0 0 1 0 .137L6.854 13.88a.632.632 0 0 1-.683-.035 3.158 3.158 0 0 0-3.461-.124 3.194 3.194 0 0 0-1.143 4.202 3.159 3.159 0 0 0 5.924-1.792.633.633 0 0 1 .31-.61l3.137-1.81a.08.08 0 0 1 .119.068V17.4a.632.632 0 0 1-.372.573 3.158 3.158 0 1 0 2.64 0 .633.633 0 0 1-.373-.573v-3.621a.08.08 0 0 1 .118-.069l3.137 1.812a.631.631 0 0 1 .31.609 3.159 3.159 0 0 0 5.924 1.792A3.194 3.194 0 0 0 21.3 13.72Z").(*string),
				Name:     "系统设置",
				Order:    2,
				ParentID: util.Ptr(uint(0)).(*uint),
				Children: []AdminMenu{
					{
						Icon:  util.Ptr("M16.279 7.13c0 1.16-.49 2.185-1.293 2.987-.891.891-2.184 1.114-2.184 1.872 0 1.025 1.65.713 3.231 2.295 1.048 1.047 1.694 2.43 1.694 4.034C17.727 21.482 15.187 24 12 24c-3.187 0-5.727-2.518-5.727-5.68 0-1.607.646-2.989 1.694-4.036 1.582-1.582 3.23-1.27 3.23-2.295 0-.758-1.292-.98-2.183-1.872-.802-.802-1.293-1.827-1.293-3.03 0-2.318 1.895-4.19 4.212-4.19.446 0 .847.067 1.181.067.602 0 .914-.268.914-.691 0-.245-.112-.557-.112-.891 0-.758.647-1.382 1.427-1.382s1.404.646 1.404 1.426c0 .825-.647 1.204-1.137 1.382-.401.134-.713.312-.713.713 0 .758 1.382 1.493 1.382 3.61zm-.446 11.19c0-2.206-1.627-3.99-3.833-3.99-2.206 0-3.833 1.784-3.833 3.99 0 2.184 1.627 3.989 3.833 3.989 2.206 0 3.833-1.808 3.833-3.99zM14.518 7.086c0-1.404-1.136-2.562-2.518-2.562S9.482 5.682 9.482 7.086 10.618 9.65 12 9.65s2.518-1.159 2.518-2.563z").(*string),
						Name:  "员工管理",
						Path:  util.Ptr("/admin/user").(*string),
						Order: 3,
					},
					{
						Icon:  util.Ptr("M12.118 5.466a2.306 2.306 0 00-.623.08c-.278.067-.702.332-.953.583-.41.423-.49.609-.662 1.469-.08.423.41 1.43.847 1.734.45.317 1.085.502 2.065.608 1.429.16 1.84.636 1.84 2.197 0 1.377-.385 1.747-1.96 1.906-1.707.172-2.58.834-2.765 2.117-.106.781.41 1.76 1.125 2.091 1.627.768 3.15-.198 3.467-2.196.211-1.284.622-1.642 1.998-1.747 1.588-.133 2.409-.675 2.713-1.787.278-1.02-.304-2.157-1.297-2.554-.264-.106-.873-.238-1.35-.291-1.495-.16-1.879-.424-2.038-1.39-.225-1.337-.317-1.562-.794-2.09a2.174 2.174 0 00-1.613-.73zm-4.785 4.36a2.145 2.145 0 00-.497.048c-1.469.318-2.17 2.051-1.35 3.295 1.178 1.774 3.944.953 3.97-1.177.012-1.193-.98-2.143-2.123-2.166zM2.089 14.19a2.22 2.22 0 00-.427.052c-2.158.476-2.237 3.626-.106 4.182.53.145.582.145 1.111.013 1.191-.318 1.866-1.456 1.549-2.607-.278-1.02-1.144-1.664-2.127-1.64zm19.824.008c-.233.002-.477.058-.784.162-1.39.477-1.866 2.092-.98 3.336.557.794 1.96 1.058 2.82.516 1.416-.874 1.363-3.057-.093-3.746-.38-.186-.663-.271-.963-.268z").(*string),
						Name:  "角色管理",
						Path:  util.Ptr("/admin/role").(*string),
						Order: 4,
					},
					{
						Icon:  util.Ptr("M22.92 3.984a5.866 5.866 0 0 0-1.2-2.09A5.757 5.757 0 0 0 19.814.49a5.505 5.505 0 0 0-4.542 0c-1.425.642-2.55 1.912-3.062 3.413a5.942 5.942 0 0 0-.268 1.158 7.588 7.588 0 0 0-.047 1.167l.02 2.247.034 4.496.011 2.248c.002.375-.002.75.004 1.124.002.186.008.378.007.56.002.18-.01.36-.014.541a7.641 7.641 0 0 1-.138 1.082c-.075.36-.189.71-.34 1.044a5.604 5.604 0 0 1-1.263 1.792c-1.076.998-2.549 1.543-3.992 1.416a5.072 5.072 0 0 1-2.073-.605 5.253 5.253 0 0 1-1.654-1.427 6.092 6.092 0 0 1-.594-.936 5.44 5.44 0 0 1-.412-1.034 5.224 5.224 0 0 1-.167-2.195c.053-.362.137-.72.248-1.063.115-.34.258-.668.428-.982.163-.305.356-.593.574-.86a4.31 4.31 0 0 1 .7-.71c1.007-.846 2.343-1.21 3.707-1.214 1.412.002 2.825.024 4.238.015l-.01-1.535c-1.408.03-2.815.128-4.22.235a7.174 7.174 0 0 0-2.287.569 6.44 6.44 0 0 0-1.04.57 5.997 5.997 0 0 0-1.66 1.646 6.194 6.194 0 0 0-.57 1.025 7.3 7.3 0 0 0-.62 2.267 7.553 7.553 0 0 0 .152 2.412c.187.805.518 1.57.976 2.258a6.4 6.4 0 0 0 1.79 1.788c.73.476 1.552.79 2.412.92.108.02.215.03.322.041.106.012.213.024.326.027.112.007.223.011.335.01a5.842 5.842 0 0 0 1.658-.24 6.783 6.783 0 0 0 1.253-.504c.402-.21.78-.47 1.135-.76a7.046 7.046 0 0 0 1.864-2.492c.05-.108.094-.216.136-.327a5.46 5.46 0 0 0 .219-.67 9.39 9.39 0 0 0 .25-1.384c.017-.233.04-.465.047-.697l.01-.302.015-.28.053-1.125.049-2.248.095-4.495.046-2.248.004-.282.002-.067.002-.047.005-.094a4.026 4.026 0 0 1 .223-1.087 3.91 3.91 0 0 1 .754-1.252 3.525 3.525 0 0 1 1.164-.856 3.421 3.421 0 0 1 1.402-.298c.487-.009.97.087 1.416.282.457.2.867.491 1.205.858.34.372.614.812.79 1.296.178.492.257 1.016.23 1.539a3.964 3.964 0 0 1-.378 1.529 3.765 3.765 0 0 1-2.35 2.016 3.836 3.836 0 0 1-.783.149l-.1.006c-.036.003-.06.006-.11.007l-.271.007-.543.015-2.02.056-.037 1.766 2.057.028.543.007.27.004.29-.003a5.584 5.584 0 0 0 3.29-1.204 5.812 5.812 0 0 0 1.523-1.861 6.19 6.19 0 0 0 .384-4.757").(*string),
						Name:  "权限管理",
						Path:  util.Ptr("/admin/permission").(*string),
						Order: 5,
					},
					{
						Icon:  util.Ptr("M12 0C5.372 0 0 5.372 0 12c0 6.626 5.372 12 12 12s12-5.372 12-12c0-6.626-5.372-12-12-12ZM9 17H7V7H9Zm8 0H11V15h6Zm0-4H11V11h6Zm0-4H11V7h6Z").(*string),
						Name:  "菜单管理",
						Path:  util.Ptr("/admin/menu").(*string),
						Order: 6,
					},
				},
			},
		}

		db.Create(menus)
	}
}

type AdminMenu struct {
	Model

	Icon  *string `gorm:"type:string;comment:图标"`
	Name  string  `gorm:"type:string;not null;comment:菜单名称"`
	Path  *string `gorm:"type:string;comment:菜单路由"`
	Order uint    `gorm:"type:uint;default:0;not null;commit:排序"`

	ParentID *uint
	Parent   *AdminMenu `gorm:"foreignKey:ParentID"`

	Children []AdminMenu `gorm:"foreignKey:ParentID"`

	Users []*AdminUser `gorm:"many2many:admin_menu_users;joinForeignKey:menu_id;joinReferences:user_id"`

	Roles []*AdminRole `gorm:"many2many:admin_menu_roles;joinForeignKey:menu_id;joinReferences:role_id"`
}
